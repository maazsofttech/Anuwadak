 
<!DOCTYPE html>
<html lang="en"> 
    <head>
        <title>Translator.js / WebRTC Voice & Text Translator</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
          
        <meta name="author" content="Maaz">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

       
        
    </head>

    <body>
  
        <blockquote id="blockquote" style="display: none;border-bottom: 0;margin: 0 13%;text-align: center;border-radius: 6px;border-style: solid;border-color: rgb(214, 210, 210);"></blockquote>
    
             <textarea id="textarea-from"></textarea><br>
            <button id="btn-convert-text" style="font-size: 16px;">Convert Your Text Input</button><br><br><br>
            <button id="btn-convert-voice" style="font-size: 16px;">Speak & Convert Your Voice</button>
         
            <textarea id="textarea-to" disabled style="background: #f9f9f9!important;border: 1px solid #f7f1f1;cursor: not-allowed;" title="Output! ReadOnly!"></textarea>
      
          
    </body>

    <script>
     

function Translator() {
    this.voiceToText = function(callback, language) {
        initTranscript(callback, language);
    };  

  /*  this.speakTextUsingRobot = function(text, args) {
        args = args || { };

        if (!args.amplitude) args.amplitude = 100;
        if (!args.wordgap) args.wordgap = 0;
        if (!args.pitch) args.pitch = 50;
        if (!args.speed) args.speed = 175;

        // args.workerPath
        // args.callback

        Speaker.Speak(text, args);
    };
    

    this.speakTextUsingGoogleSpeaker = function(args) {
        var textToSpeak = args.textToSpeak;
        var targetLanguage = args.targetLanguage;

        textToSpeak = textToSpeak.replace( /%20| /g , '+');
        if (textToSpeak.substr(0, 1) == ' ' || textToSpeak.substr(0, 1) == '+') {
            textToSpeak = textToSpeak.substr(1, textToSpeak.length - 1);
        }

        var audio_url = 'https://translate.google.com/translate_tts?ie=UTF-8&total=1&idx=0&textlen=' + textToSpeak.length + '&tl=' + targetLanguage + '&q=' + textToSpeak;

        if (args.callback) args.callback(audio_url);
        else {
            var audio = document.createElement('audio');
            audio.onerror = function(event) {
                audio.onerror = null;
                audio.src = 'https://translate.google.com/translate_tts?ie=UTF-8&total=1&idx=0&textlen=' + textToSpeak.length + '&tl=' + targetLanguage + '&q= ' + textToSpeak;
            };
            audio.src = audio_url;
            audio.autoplay = true;
            audio.play();
        }
    };
    */ 

    this.translateLanguage = function(text, config) {
        config = config || { };
        // please use your own API key; if possible
        var api_key = config.api_key || Google_Translate_API_KEY;

        var newScript = document.createElement('script');
        newScript.type = 'text/javascript';

        var sourceText = encodeURIComponent(text); // escape

        var randomNumber = 'method' + (Math.random() * new Date().getTime()).toString(36).replace( /\./g , '');
        window[randomNumber] = function(response) {
            if (response.data && response.data.translations[0] && config.callback) {
                config.callback(response.data.translations[0].translatedText);
                return;
            }

            if(response.error && response.error.message == 'Daily Limit Exceeded') {
                config.callback('Google says, "Daily Limit Exceeded". Please try this experiment a few hours later.');
                return;
            }

            if (response.error) {
                console.error(response.error.message);
                return;
            }

            console.error(response);
        };

        var source = 'https://www.googleapis.com/language/translate/v2?key=' + api_key + '&target=' + (config.to || 'en-US') + '&callback=window.' + randomNumber + '&q=' + sourceText;
        newScript.src = source;
        document.getElementsByTagName('head')[0].appendChild(newScript);
    };

    this.getListOfLanguages = function (callback, config) {
        config = config || {};

        var api_key = config.api_key || Google_Translate_API_KEY;

        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState == XMLHttpRequest.DONE) {
                var response = JSON.parse(xhr.responseText);

                if(response && response.data && response.data.languages) {
                    callback(response.data.languages);
                    return;
                }

                if (response.error && response.error.message === 'Daily Limit Exceeded') {
                    console.error('Text translation failed. Error message: "Daily Limit Exceeded."');
                    return;
                }

                if (response.error) {
                    console.error(response.error.message);
                    return;
                }

                console.error(response);
            }
        }
        var url = 'https://www.googleapis.com/language/translate/v2/languages?key=' + api_key + '&target=en';
        xhr.open('GET', url, true);
        xhr.send(null);
    };

    var recognition;

    function initTranscript(callback, language) {
        if (recognition) recognition.stop();

        window.SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        recognition = new SpeechRecognition();

        recognition.lang = language || 'en-US';

        console.log('SpeechRecognition Language', recognition.lang);

        recognition.continuous = true;
        recognition.interimResults = true;

        recognition.onresult = function(event) {
            for (var i = event.resultIndex; i < event.results.length; ++i) {
                if (event.results[i].isFinal) {
                    callback(event.results[i][0].transcript);
                }
            }
        };

        recognition.onend = function() {
            if(recognition.dontReTry === true) {
                return;
            }

            initTranscript(callback, language);
        };

        recognition.onerror = function(e) {
            if(e.error === 'audio-capture') {
                recognition.dontReTry = true;
                alert('Failed capturing audio i.e. microphone. Please check console-logs for hints to fix this issue.');
                console.error('No microphone was found. Ensure that a microphone is installed and that microphone settings are configured correctly. https://support.google.com/chrome/bin/answer.py?hl=en&answer=1407892');
                console.error('Original', e.type, e.message.length || e);
                return;
            }

            console.error(e.type, e.error, e.message);
        };

        recognition.start();
    }

  /*  var self = this;
    self.processInWebWorker = function(args) {
        console.log('Downloading worker file. Its about 2MB in size.');

        if (!self.speakWorker && args.onWorkerFileDownloadStart) args.onWorkerFileDownloadStart();

        var blob = URL.createObjectURL(new Blob(['importScripts("' + (args.workerPath || '//www.webrtc-experiment.com/Robot-Speaker.js') + '");this.onmessage =  function (event) {postMessage(generateSpeech(event.data.text, event.data.args));}; postMessage("worker-file-downloaded");'], {
            type: 'application/javascript'
        }));

        var worker = new Worker(blob);
        URL.revokeObjectURL(blob);
        return worker;
    };

    var Speaker = {
        Speak: function(text, args) {
            var callback = args.callback;
            var onSpeakingEnd = args.onSpeakingEnd;

            if (!speakWorker) {
                self.speakWorker = self.processInWebWorker(args);
            }

            var speakWorker = self.speakWorker;

            speakWorker.onmessage = function(event) {

                if (event.data == 'worker-file-downloaded') {
                    console.log('Worker file is download ended!');
                    if (args.onWorkerFileDownloadEnd) args.onWorkerFileDownloadEnd();
                    return;
                }
                */

            /*    function encode64(data) {
                    var BASE = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';
                    var PAD = '=';
                    var ret = '';
                    var leftchar = 0;
                    var leftbits = 0;
                    for (var i = 0; i < data.length; i++) {
                        leftchar = (leftchar << 8) | data[i];
                        leftbits += 8;
                        while (leftbits >= 6) {
                            var curr = (leftchar >> (leftbits - 6)) & 0x3f;
                            leftbits -= 6;
                            ret += BASE[curr];
                        }
                    }
                    if (leftbits == 2) {
                        ret += BASE[(leftchar & 3) << 4];
                        ret += PAD + PAD;
                    } else if (leftbits == 4) {
                        ret += BASE[(leftchar & 0xf) << 2];
                        ret += PAD;
                    }
                    return ret;
                }

                var audio_url = 'data:audio/x-wav;base64,' + encode64(event.data);

                if (callback) {
                    callback(audio_url);
                } else {
                    var audio = document.createElement('audio');
                    audio.onended = function() {
                        if (onSpeakingEnd) onSpeakingEnd();
                    };
                    audio.src = audio_url;
                    audio.play();
                }
            };

            var _args = args;
            if (_args.onSpeakingEnd) delete _args.onSpeakingEnd;
            if (_args.callback) delete _args.callback;
            if (_args.onWorkerFileDownloadEnd) delete _args.onWorkerFileDownloadEnd;
            if (_args.onWorkerFileDownloadStart) delete _args.onWorkerFileDownloadStart;

            speakWorker.postMessage({ text: text, args: _args });
        }
    };   */
    
    var Google_Translate_API_KEY = 'AIzaSyAdvVVp6_nS2YIqqhWCdupIZ6tuOhQX7mE';
}
    
    
    
    
    
    
    
    
    
    </script>
    
    <script>
  
        var translator = new Translator();

     

    //    var convertFrom = document.getElementById('convert-from');
    //    var convertInto = document.getElementById('convert-into');

     
        
        var textareaFrom = document.getElementById('textarea-from');
        var textareaTo = document.getElementById('textarea-to');
        
        function getLanguages() {
            //var from = document.getElementById('convert-from').value.split(' (')[0];
            //var to = document.getElementById('convert-into').value.split(' (')[0];
            var from = "en";
            var to = "hi" ;
             
            
            return {
                from: from,
                to: to
            };
        }
        
        document.getElementById('btn-convert-voice').onclick = function() {
            this.disabled = true;
            this.innerHTML = 'Start Speaking!';

            var languages = getLanguages();
            
            translator.voiceToText(function(text) {
                textareaFrom.value = text;
                
                document.getElementById('btn-convert-text').onclick(true);
            }, languages.from);
        };
        
        document.getElementById('btn-convert-text').onclick = function(speakAsWell) {
            var languages = getLanguages();
            
            textareaTo.value = 'Converting into >> en ' ;//+ document.getElementById('convert-into').value;
        
            translator.translateLanguage(textareaFrom.value, {
                from: languages.from,
                to: languages.to,
                callback: function(translatedText) {
                    textareaTo.value = translatedText;
                    localStorage.setItem('textarea-to', textareaTo.value);
                
                    if(speakAsWell !== true) return;
       /*             if (document.getElementById('robot-voice').checked) {
                        translator.speakTextUsingRobot(translatedText, {
                            workerPath: 'https://cdn.webrtc-experiment.com/Robot-Speaker.js',
                            onWorkerFileDownloadStart: function() {
                                console.log('Downloading worker file. It is about 2MB in size.');
                            },
                            onWorkerFileDownloadEnd: function() {
                                console.log('Worker file is downloaded.');
                            }
                        });
                    } else {
                        translator.speakTextUsingGoogleSpeaker({
                            textToSpeak: translatedText,
                            targetLanguage: languages.to,

                            // please use your own API key; if possible
                            api_key: 'AIzaSyAdvVVp6_nS2YIqqhWCdupIZ6tuOhQX7mE'
                        });
                    } */
                }
            });
        };
        
    /*    document.getElementById('convert-from').onchange = function() {
            localStorage.setItem('convert-from', this.value);
        };
        
        document.getElementById('convert-into').onchange = function() {
            localStorage.setItem('convert-into', this.value);
        }; */
        
        textareaFrom.onchange = function() {
            localStorage.setItem('textarea-from', this.value);
        };
        
        textareaTo.onchange = function() {
            localStorage.setItem('textarea-to', this.value);
        };
        
    /*    document.getElementById('robot-voice').onchange = function() {
            localStorage.setItem('robot-checked', this.checked + '');
        }; */

        function localStorageGetItem() {
         /*   if(localStorage.getItem('convert-from')) {
                document.getElementById('convert-from').value = localStorage.getItem('convert-from');
              
            }
            
            if(localStorage.getItem('convert-into')) {
                document.getElementById('convert-into').value = localStorage.getItem('convert-into');
            } */

            if(localStorage.getItem('textarea-from')) {
                textareaFrom.value = localStorage.getItem('textarea-from');
            }
            
            if(localStorage.getItem('textarea-to')) {
                textareaTo.value = localStorage.getItem('textarea-to');
            }
            
           /* if(localStorage.getItem('robot-checked')) {
                document.getElementById('robot-voice').checked = localStorage.getItem('robot-checked') === 'true';
            } */
        }

     //   localStorageGetItem();
     //https://ngrok.com/
    </script>
     
    <!-- commits.js is useless for you! -->
    
 <!--   <script src="https://cdn.webrtc-experiment.com/commits.js" async> </script> -->
</html>
